/*
 * Wallaby.js - v1.0.1328
 * https://wallabyjs.com
 * Copyright (c) 2014-2022 Wallaby.js - All Rights Reserved.
 *
 * This source code file is a part of Wallaby.js and is a proprietary (closed source) software.

 * IMPORTANT:
 * Wallaby.js is a tool made by software developers for software developers with passion and love for what we do.
 * Pirating the tool is not only illegal and just morally wrong,
 * it is also unfair to other fellow programmers who are using it legally,
 * and very harmful for the tool and its future.
 */
var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++){t=arguments[i];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},__assign.apply(this,arguments)},__awaiter=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r["throw"](e))}catch(t){s(t)}}function l(e){e.done?i(e.value):n(e.value).then(o,a)}l((r=r.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function i(e){return function(t){return r([e,t])}}function r(i){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,s&&(o=2&i[0]?s["return"]:i[0]?s["throw"]||((o=s["return"])&&o.call(s),0):s.next)&&!(o=o.call(s,i[1])).done)return o;switch(s=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,s=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(o=l.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){l.label=i[1];break}if(6===i[0]&&l.label<o[1]){l.label=o[1],o=i;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(i);break}o[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(r){i=[6,r],s=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var n,s,o,a,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},__read=this&&this.__read||function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,s=i.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(a){n={error:a}}finally{try{r&&!r.done&&(i=s["return"])&&i.call(s)}finally{if(n)throw n.error}}return o},__spreadArray=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var r,n=0,s=t.length;n<s;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))},path=require("path"),fs=require("fs"),crypto=require("crypto"),writeFileAtomic=require("write-file-atomic").sync,tracer=global.$_$tracer,workerId=tracer.workerId,utils=tracer._utils,handleUncaughtException=tracer._handleUncaughtException,localProjectRoot=path.dirname(global.wallaby._localNodeModules),originalCacheRoot=global.wallaby._originalCacheRoot,jasmineInitializerPath=path.join(__dirname,"jasmineInitializer.js"),jestRuntime,jestConfig,createTestScheduler,jestRunGlobalHook,prettyFormat,clearDefaultResolverCache;process.env.VUE_CLI_BABEL_TRANSPILE_MODULES=!0,process.env.BABEL_ENV||(process.env.BABEL_ENV="test"),process.env.NODE_ENV||(process.env.NODE_ENV="test"),process.env.PUBLIC_URL="",process.env.JEST_WORKER_ID=workerId;var utilsLazyLoadDependencyReplacement=fs.existsSync(path.join(localProjectRoot,"node_modules/mock-fs"))?function(){return[]}:utils.lazyLoadDependencyReplacement;utils.patchModulesCode([{files:["@jest/transform/build/ScriptTransformer.js"],replacements:[{from:"const getScriptCacheKey = (filename, instrument) => {",to:"const getScriptCacheKey = (filename, instrument) => { var wallabyKey = global.$_$tracer._fileCacheKey(filename); if (wallabyKey) return wallabyKey;"},{from:"constructor(config) {",to:"constructor(config) { var _getTransformer = this._getTransformer; this._getTransformer = function(filename) { var transformer = _getTransformer.apply(this, arguments); return global.$_$tracer._extendJestTransformer ? global.$_$tracer._extendJestTransformer(filename, transformer) : transformer; };",optional:!0},{from:"this._config = _config;",to:"this._config = _config; var _getTransformer = this._getTransformer; this._getTransformer = function(filename) { var transformer = _getTransformer.apply(this, arguments); return global.$_$tracer._extendJestTransformer ? global.$_$tracer._extendJestTransformer(filename, transformer) : transformer; };",optional:!0},{from:"!!this._config.transform && !!this._config.transform.length && !isIgnored",to:"!isIgnored",optional:!0},{from:"this._config.transform.length !== 0 && !isIgnored",to:"!isIgnored",optional:!0},{from:"transform(filename, options, fileSource) {",to:"transform(filename, options, fileSource) { var wallabyFileId = global.$_$tracer._fileId(filename); if (wallabyFileId) { global.$_$tracer.programScopeStartLoading(wallabyFileId); }"},{from:"transformAsync(filename, options, fileSource) {",to:"transformAsync(filename, options, fileSource) { var wallabyFileId = global.$_$tracer._fileId(filename); if (wallabyFileId) { global.$_$tracer.programScopeStartLoading(wallabyFileId); }",optional:!0},{from:"function assertSyncTransformer(transformer, name) {",to:"function assertSyncTransformer(transformer, name) { return;",optional:!0},{from:"code = this._config.cache ? readCodeCacheFile(cacheFilePath)",to:"code = this._config.cache ? global.$_$tracer._readCodeCacheFile(filename, cacheFilePath, readCodeCacheFile, readCacheFile)",optional:!1}]},{files:["@jest/core/build/jest.js","@jest/core/build/index.js"],replacements:[{from:"'use strict';",to:"'use strict'; exports.runGlobalHook = _interopRequireDefault(require('./runGlobalHook'));"}]},{files:["jest-resolve/build/defaultResolver.js"],replacements:[{from:"const checkedPaths = new Map();",to:"const checkedPaths = new Map(); checkedPaths.get = function() {};",optional:!0}]},{files:["jest-message-util/build/index.js"],replacements:[{from:"${renderedCallsite}\\n${stacktrace}",to:"${stacktrace}"}]},{files:["vue-jest/lib/process.js"],replacements:[{from:"return { code: output }",to:"return { code: output, scriptSrc: parts.script && parts.script.src }",optional:!0},{from:"code: output.code,",to:"code: output.code, scriptSrc: descriptor.script && descriptor.script.src,",optional:!0},{from:"const { descriptor } = parse(src)",to:"const { descriptor } = parse(src, { pad: true })",optional:!0}]},{files:["react-app-rewired/scripts/test.js"],replacements:[{from:"require(`${scriptVersion}/scripts/test`);",to:"module.exports = require('../overrides/jest')();",optional:!0},{from:"if (paths.customScriptsIndex > -1) {",to:"module.exports = config; return; if (paths.customScriptsIndex > -1) {",optional:!0}]},{files:["jest-snapshot/build/inline_snapshots.js","jest-snapshot/build/InlineSnapshots.js"],replacements:[{from:"_callee$property$loc$.column",to:"0",optional:!0},{from:"${column - 1}",to:"0",optional:!0},{from:"const {line, column} = callee.property.loc.start;",to:'const {line } = callee.property.loc.start; const column = 0; if(callee.property.name !== "toMatchInlineSnapshot") return;',optional:!0},{from:"const snapshotsByFile = groupSnapshotsByFile(snapshots);",to:"global.$_$tracer._remapInlineSnapshots(snapshots); const snapshotsByFile = groupSnapshotsByFile(snapshots);"}]},{files:["jest-snapshot/build/State.js"],replacements:__spreadArray(__spreadArray([{from:"const pass = expected === receivedSerialized;",to:"const pass = expected === receivedSerialized; global.$_$tracer._matchSnapshot({key, snapshotPath: this._snapshotPath});"},{from:"hasSnapshot && this._updateSnapshot === 'all'",to:"hasSnapshot && (!global.$_$tracer._updateNoMoreThanOneSnapshotPerTestFileRun || !pass && (this.updated === 0)) && this._updateSnapshot === 'all'"},{from:"this._updateSnapshot === 'all' && this._uncheckedKeys.size",to:"this._updateSnapshot === 'all' && (!global.$_$tracer._updateNoMoreThanOneSnapshotPerTestFileRun || (this.updated === 0)) && this._uncheckedKeys.size"}],__read(utilsLazyLoadDependencyReplacement("_InlineSnapshots","./InlineSnapshots")),!1),__read(utilsLazyLoadDependencyReplacement("_jestMessageUtil","jest-message-util")),!1)},{files:["jest-jasmine2/build/jasmine/Env.js","expect/build/toThrowMatchers.js"],replacements:__spreadArray([],__read(utilsLazyLoadDependencyReplacement("_jestMessageUtil","jest-message-util")),!1)},{files:["jest-matcher-utils/build/index.js"],replacements:__spreadArray([],__read(utilsLazyLoadDependencyReplacement("_jestDiff","jest-diff",{dependencyOverride:"_interopRequireWildcard(require('jest-diff'))",replaceBothDependencyAndDependencyOverride:!0})),!1)},{files:["@testing-library/jest-dom/dist/to-be-checked.js","@testing-library/dom/dist/queries/role.js"],replacements:utilsLazyLoadDependencyReplacement("_ariaQuery","aria-query",{doubleQuotes:!0})},{files:["@testing-library/dom/dist/role-helpers.js"],replacements:__spreadArray(__spreadArray([],__read(utilsLazyLoadDependencyReplacement("_ariaQuery","aria-query",{doubleQuotes:!0})),!1),__read(utilsLazyLoadDependencyReplacement("elementRoleList",void 0,{dependencyOverride:"buildElementRoleList(_ariaQuery().elementRoles)",varType:"const"})),!1)},{files:["@testing-library/dom/dist/pretty-dom.js"],replacements:utilsLazyLoadDependencyReplacement("_getUserCodeFrame","./get-user-code-frame",{doubleQuotes:!0})},{files:["ts-jest/dist/config/config-set.js"],replacements:[{from:"this._overriddenCompilerOptions = {",to:"this._overriddenCompilerOptions = { sourceMap: true, "}]},{files:["ts-jest/dist/compiler/ts-compiler.js"],replacements:[{from:"if (watchMode) {",to:"if (true) {"},{from:"this._updateMemoryCache(this._getFileContentFromCache(fileToReTypeCheck),",to:"var content = this._getFileContentFromCache(fileToReTypeCheck); if (!content) continue; this._updateMemoryCache(content,"}]},{files:["ts-jest/dist/compiler.js"],replacements:[{from:"getScriptVersion: function (fileName) {",to:'getScriptVersion: function (fileName) { fileName = require("path").normalize(fileName);'},{from:"getScriptSnapshot: function (fileName) {",to:'getScriptSnapshot: function (fileName) { fileName = require("path").normalize(fileName);'}]},{files:["jest-runner/build/index.js"],replacements:[{from:"process.env.JEST_WORKER_ID = '1';",to:""}]},{files:["jest-jasmine2/build/jasmine/Env.js"],replacements:[{from:"oldListenersException = process",to:"oldListenersException = (j$.process || process)"},{from:"oldListenersRejection = process",to:"oldListenersRejection = (j$.process || process)"}]},{files:["jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js"],replacements:[{from:"(0, _state.addEventHandler)(eventHandler);",to:"(0, _state.addEventHandler)(eventHandler); (0, _state.addEventHandler)(new global.$_$tracer.CircusReporter(global.$_$tracer).handler);"},{from:"testNamePattern: globalConfig.testNamePattern",to:"testNamePattern: globalConfig.testNamePattern, testPath"}]},{files:["jest-circus/build/run.js"],replacements:[{from:"(hasFocusedTests && test.mode !== 'only') ||",to:"(hasFocusedTests && test.mode !== 'only') || (global.$_$tracer.jestCircusSkipTest && global.$_$tracer.jestCircusSkipTest(test)) || "}]},{files:["jest-circus/build/eventHandler.js"],replacements:[{from:"case 'error': {",to:"case 'error': {\n          if (state.currentlyRunningTest && state.currentlyRunningTest._reject) {\n            state.currentlyRunningTest._reject(event.error);\n            delete state.currentlyRunningTest._reject;\n            break;\n          }"}]},{files:["jest-circus/build/utils.js"],replacements:[{from:"(hasFocusedTests && child.mode !== 'only') ||",to:"(hasFocusedTests && child.mode !== 'only') || (global.$_$tracer.jestCircusSkipTest && global.$_$tracer.jestCircusSkipTest(child)) || "},{from:"timeoutID = setTimeout(",to:"testOrHook._reject = reject;timeoutID = setTimeout("},{from:"clearTimeout(timeoutID);",to:"clearTimeout(timeoutID);delete testOrHook._reject;"}]},{files:["jest-util/build/setGlobal.js"],replacements:[{from:"globalToMutate[key] = value;",to:"globalToMutate[key] = value;\n             if (!globalToMutate.regeneratorRuntime && global.regeneratorRuntime) {\n              globalToMutate.regeneratorRuntime = global.regeneratorRuntime;\n             }\n             globalToMutate.$_$wp = global.$_$wp;\n             globalToMutate.$_$wpe = global.$_$wpe;\n             globalToMutate.$_$w = global.$_$w;\n             globalToMutate.$_$w_ = global.$_$w_;\n             globalToMutate.$_$wf = global.$_$wf;\n             globalToMutate.$_$wv = global.$_$wv;\n             globalToMutate.$_$tracer = global.$_$tracer;\n             globalToMutate.nodeGlobal = global;\n             global.$_$tracer.setEnvGlobal(globalToMutate);\n             globalToMutate.$_$tracer._jasmineAdapter = new global.$_$tracer.JasmineReporter(global.$_$tracer);\n        "}]},{files:["jest-util/build/tryRealpath.js"],replacements:[{from:"path = _gracefulFs().realpathSync.native(path);",to:"const newPath = _gracefulFs().realpathSync.native(path);\n        path = (process.platform === 'win32' && path.substr(0, 1).toLowerCase() !== newPath.substr(0, 1).toLowerCase()) ? path : newPath;"}]},{files:["next/dist/build/swc/jest-transformer.js"],replacements:[{from:"return((0, _index).transformSync(src, {",to:"(swcTransformOpts.jsc.transform.optimizer && delete swcTransformOpts.jsc.transform.optimizer); swcTransformOpts.sourceMaps = true; return((0, _index).transformSync(src, {"},{from:"return (0, _index).transformSync(src, {",to:"(swcTransformOpts.jsc.transform.optimizer && delete swcTransformOpts.jsc.transform.optimizer); swcTransformOpts.sourceMaps = true; return (0, _index).transformSync(src, {"}]},{files:["jest-preset-angular/build/utils/ngcc-jest-processor.js"],replacements:[{from:"process.stderr, process.stderr",to:"process.stdout, process.stdout",optional:!0}]}],"Possibly incompatible/unsupported Jest version");var compactErrorMessage=function(e){if(e&&0===e.indexOf("Error: expect(")&&e.indexOf(".toMatchSnapshot(")===-1&&e.indexOf(".toThrowErrorMatchingSnapshot(")===-1){var t=e.split("\n");return t.shift(),t[0]&&0!==t[0].length||t.shift(),t.join("\n")}return e},CircusReporter=function(e){var t,i,r=global.$_$session,n=e.initialSpecId(),s=function(e){var t=[],i=e;do t.unshift(i.name);while(i=i.parent);return t.shift(),t};e.jestCircusSkipTest=function(t){return!!e.hasSpecFilter()&&!e.specFilter(s(t))};var o=function(e){var t=s(e);return t.pop(),t},a=function(e){return s(e).filter(function(e){return!!e}).join(" > ")};this.handler=function(s){if(r===global.$_$session)if("setup"===s.name)i=e._fileId(s.testPath);else if("run_finish"===s.name)global.$_$initialSpecId=n+1;else if("run_start"===s.name)e.started({total:"unknown number of"});else if("test_start"===s.name)n++,e.specStart(n,a(s.test));else if("test_fn_start"===s.name)e.specSyncStart(),t=(new e._Date).getTime();else if("test_todo"===s.name){e.specSyncEnd();var l=e.specEnd();e.result({id:n,timeRange:l,name:s.test.name,suite:o(s.test),status:"todo",time:0,testFile:i})}else if("test_skip"===s.name){e.specSyncEnd();var l=e.specEnd();e.jestCircusSkipTest(s.test)||e.result({id:n,timeRange:l,name:s.test.name,suite:o(s.test),status:"skipped",time:0,testFile:i})}else if("test_done"===s.name){e.specSyncEnd();for(var l=e.specEnd(),c={id:n,timeRange:l,name:s.test.name,suite:o(s.test),status:"executed",time:(new e._Date).getTime()-t,log:[],testFile:e.entryFile()},u=0;u<s.test.errors.length;u++){var h=s.test.errors[u];Array.isArray(h)&&(h[0]&&("string"==typeof h[0].stack||h[0].message)?h=h[0]:(h[1].message="thrown: "+prettyFormat()(h[0],{maxDepth:3}),h=h[1]));var d={error:h,passed:!1};d.message=compactErrorMessage(h?h.name&&h.message?h.name+": "+h.message:h.toString():"empty error"),d.stack=h?h.stack:null,d.message&&0===d.message.indexOf("Error: expect(")&&(d.message=d.message.replace("Error: ","")),d.error.matcherResult?(d.matcherName=d.error.matcherResult.name,d.actual=d.error.matcherResult.actual,d.expected=d.error.matcherResult.expected):(d.showDiff=d.error.showDiff,d.actual=d.error.actual,d.expected=d.error.expected),d.showDiff=d.showDiff||"toEqual"===d.matcherName||"toStrictEqual"===d.matcherName||"toBe"===d.matcherName||"toMatchSnapshot"===d.matcherName||"toMatchInlineSnapshot"===d.matcherName||"toThrowErrorMatchingSnapshot"===d.matcherName,c.log.push(e.setAssertionData(d,{message:d.message||"",stack:d.stack}))}c.log.length||delete c.log,e.result(c)}}},JasmineReporter=function(e){var t=global.$_$session,i=e.initialSpecId(),r=[],n=function(){return t!==global.$_$session};this.jasmineDone=function(){n()||(global.$_$initialSpecId=i+1)},this.jasmineStarted=function(){n()||e.started({total:"unknown number of"})},this.suiteStarted=function(e){n()||r.push(e.description)},this.suiteDone=function(){n()||r.pop()},this.specStarted=function(t){n()||(t._id=++i,e.specStart(t._id,t.fullName),t._time=(new e._Date).getTime())},this.specDone=function(t){if(!n()){var i=e.specEnd(),s="passed"===t.status,o="disabled"===t.status||"pending"===t.status||"todo"===t.status,a=o?"pending"===t.status?"skipped":"todo"===t.status?"todo":"disabled"===t.status?"disabled":"executed":"executed",l={id:t._id,timeRange:i,name:t.description,suite:r.slice(),status:a,time:o?0:(new e._Date).getTime()-t._time,log:[],testFile:t._testFile};if(!s&&!o)for(var c=t.failedExpectations,u=0;u<c.length;u++){var h=c[u];h.error&&(h.message=compactErrorMessage(h.message),h.error.matcherResult?(h.matcherName=h.error.matcherResult.name,h.actual=h.error.matcherResult.actual,h.expected=h.error.matcherResult.expected):(h.showDiff=h.error.showDiff,h.actual=h.error.actual,h.expected=h.error.expected)),h.showDiff=h.showDiff||"toEqual"===h.matcherName||"toStrictEqual"===h.matcherName||"toBe"===h.matcherName||"toMatchSnapshot"===h.matcherName||"toMatchInlineSnapshot"===h.matcherName||"toThrowErrorMatchingSnapshot"===h.matcherName,l.log.push(e.setAssertionData(h,{message:h.message,stack:h.stack}))}l.log.length||delete l.log,e.result(l)}}};tracer.JasmineReporter=JasmineReporter,tracer.CircusReporter=CircusReporter;var WallabyRunner=function(){function e(e){this._sessionId=e,this._runComplete=!1}return e.prototype.onRunStart=function(){},e.prototype.onTestStart=function(){},e.prototype.isActive=function(){return this._sessionId===global.$_$session},e.prototype.getLastError=function(){return this._error},e.prototype._setError=function(e){this._error=e},e.prototype.completeRun=function(e){!this._runComplete&&this.isActive()&&(this._runComplete=!0,tracer.resetEnvGlobal(),tracer.complete(e))},e.prototype.onTestResult=function(e,t){t.testExecError&&this.isActive()&&(tracer.reportGlobalErrorObject(__assign(__assign({},t.testExecError),{message:t.testExecError.message,stack:t.testExecError.stack,testFilePath:t.testFilePath})),this.completeRun())},e.prototype.onRunComplete=function(e,t){!tracer.canUpdateSnapshots()&&t&&t.testResults&&t.testResults.forEach&&t.testResults.forEach(function(e){if(e&&e.snapshot&&e.snapshot.unchecked){var t=e.snapshot.unchecked+" snapshot"+(e.snapshot.unchecked>1?"s":"")+" obsolete "+(e.snapshot.uncheckedKeys&&"\n\t"+e.snapshot.uncheckedKeys.join("\n\t")||"");tracer.reportGlobalErrorObject({message:t,stack:t+"\n    at "+e.testFilePath+":1:0",snapshot:!0,allowNotMappedStackLines:!0})}}),this.completeRun()},e}(),initializeJest=function(){return __awaiter(void 0,void 0,void 0,function(){var e,t,i,r,n,s,o,a,l,c,u,h;return __generator(this,function(d){switch(d.label){case 0:return[4,utils.loadJest(localProjectRoot,global.wallaby._testFrameworkPath,global.wallaby._testConfigFile)];case 1:if(e=d.sent()||{},t=e.jestCLI,i=e.jestConfigLoader,jestConfig=global.wallaby.customJestConfig||e.jestConfig,!t)throw new Error("Can not find jest-cli module");if(!jestConfig)throw new Error("Can not load jest config");if(!i)throw new Error("Can not find jest-config module");if(jestRuntime=utils.tryRequireModuleWithPathFrom(i.path,"jest-runtime",1),!jestRuntime)throw new Error("Can not find Jest runtime module");if(!jestRuntime.module.createContext)throw new Error("Can not find compatible Jest runtime module, module path: "+jestRuntime.path+")");if(r=utils.tryRequireModuleWithPathFrom(t.path,"@jest/core"),!r)throw new Error("Can not find Jest core module");if(n=utils.tryRequireModuleWithPathFrom(jestRuntime.path,"jest-resolve"))try{clearDefaultResolverCache=n.module.clearDefaultResolverCache}catch(p){clearDefaultResolverCache=void 0}if(prettyFormat=function(){return s||(s=utils.tryRequireModuleWithPathFrom(i.path,"pretty-format",1).module),s},o=r.module.TestScheduler,createTestScheduler=o?function(e){return new o(e)}:r.module.createTestScheduler,!createTestScheduler)throw new Error("Can not find Jest test scheduler module");return a=utils.tryRequireModuleWithPathFrom(r.path,"@jest/reporters"),a?(l=function(e,t){var i=e.prototype;i.log=i._write=t?function(){}:function(e){console.log("Jest: "+e+"\n")}},l(a.module.BaseReporter),l(a.module.DefaultReporter),l(a.module.SummaryReporter,!0)):console.warn("Can not find Jest reporters module"),jestRunGlobalHook=r.module.runGlobalHook?{module:r.module.runGlobalHook["default"]||r.module.runGlobalHook}:utils.tryRequireModuleWithPathFrom(t.path,"@jest/core/build/runGlobalHook"),jestRunGlobalHook||console.warn("Can not find Jest run global hook module"),c=utils.tryRequireModuleWithPathFrom(t.path,"@jest/console"),c?(u=function(e){var t=e.prototype;["log","warn","error","dir","debug","info"].forEach(function(e){var i=t[e];i&&(t[e]=function(){return tracer._suppressConsoleLog||tracer["_"+e].apply(tracer,arguments),i.apply(this,arguments)})})},u(c.module.BufferedConsole),u(c.module.CustomConsole),u(c.module.NullConsole)):console.warn("Can not find Jest console module"),jestConfig.configs=(jestConfig.configs||[]).filter(function(e){return"jest-runner"===e.runner||~utils.normalizePath(e.runner||"").indexOf("node_modules/jest-runner/")||"jest-runner-groups"===e.runner||~utils.normalizePath(e.runner||"").indexOf("node_modules/jest-runner-groups/")}),jestConfig.configs.forEach(function(e){if(e.bail=0,e.notify=0,e.collectCoverage=!1,e.collectCoverageFrom=e.collectCoverageFrom||(jestConfig.globalConfig||{}).collectCoverageFrom,e.collectCoverageFrom&&e.collectCoverageFrom.length||(e.collectCoverageFrom=["**/*."+(1===e.moduleFileExtensions.length?e.moduleFileExtensions[0]:"{"+e.moduleFileExtensions.join(",")+"}")]),e.coveragePathIgnorePatterns=e.coveragePathIgnorePatterns&&e.coveragePathIgnorePatterns.map(function(e){return new RegExp(e)}),e.errorOnDeprecated=!1,e.setupFilesAfterEnv=e.setupFilesAfterEnv||[],e.transformIgnorePatterns=e.transformIgnorePatterns||[],e.testRunner.indexOf("jest-circus")!==-1){if(void 0!==process.env.WALLABY_JEST_CIRCUS&&(!process.env.WALLABY_JEST_CIRCUS||"false"===process.env.WALLABY_JEST_CIRCUS)){var t=e.testRunner.replace("jest-circus/runner","jest-jasmine2/build/index").replace("jest-circus\\runner","jest-jasmine2\\build\\index");try{e.testRunner=require.resolve("jest-jasmine2",{paths:[localProjectRoot]})}catch(i){e.testRunner=void 0}e.testRunner||(e.testRunner=t),e.setupFilesAfterEnv.unshift(jasmineInitializerPath),e.transformIgnorePatterns.push(utils.replacePathSepForRegex(path.join(path.basename(path.dirname(jasmineInitializerPath)),path.basename(jasmineInitializerPath))))}}else e.setupFilesAfterEnv.unshift(jasmineInitializerPath),e.transformIgnorePatterns.push(utils.replacePathSepForRegex(path.join(path.basename(path.dirname(jasmineInitializerPath)),path.basename(jasmineInitializerPath))));if(e.verbose=null,delete e.watchPlugins,delete e.testResultsProcessor,delete e.reporters,e.globals=e.globals||{},e.globals["ts-jest"]=e.globals["ts-jest"]||{},e.globals["ts-jest"].diagnostics!==!0&&(e.globals["ts-jest"].diagnostics=!1),e.resolver){var r=path.join("node_modules","@nrwl","jest","plugins","resolver.js");if(e.resolver.endsWith(r)){var n=path.dirname(path.dirname(path.dirname(path.dirname(path.dirname(e.resolver))))),s=path.join(n,"angular.json"),o=path.join(n,"workspace.json"),a=fs.existsSync(s)?s:fs.existsSync(o)?o:void 0;if(a&&fs.statSync(a)){var l=path.relative(n,e.rootDir).replace(/\\/,"/");try{var c=JSON.parse(fs.readFileSync(a).toString()),u=Object.keys(c.projects).map(function(e){return __assign({},c.projects[e])}).filter(function(e){return e.root===l}).filter(function(e){return e.architect&&e.architect.test&&"@nrwl/jest:jest"===e.architect.test.builder}).map(function(e){return e.architect.test.options});if(1===u.length){var h=u[0].tsConfig,d=u[0].setupFile;h&&(e.globals["ts-jest"].tsConfig="<rootDir>/"+path.relative(l,h)),d&&e.setupFilesAfterEnv.push(path.resolve(n,d)),e.globals["ts-jest"].stringifyContentPathRegex="\\.html$",a===s&&(utils.tryRequireModuleWithPathFrom(localProjectRoot,"jest-preset-angular/InlineHtmlStripStylesTransformer")?e.globals["ts-jest"].astTransformers=["jest-preset-angular/InlineHtmlStripStylesTransformer"]:utils.tryRequireModuleWithPathFrom(localProjectRoot,"jest-preset-angular/build/InlineFilesTransformer")&&(e.globals["ts-jest"].astTransformers=["jest-preset-angular/build/InlineFilesTransformer","jest-preset-angular/build/StripStylesTransformer"]))}}catch(i){}}}}}),h=jestConfig.globalConfig,h.notify=!1,h.bail=0,h.collectCoverage=!1,h.detectLeaks=!1,h.detectOpenHandles=!1,h.errorOnDeprecated=!1,h.json=!1,h.maxWorkers=1,h.useStderr=!1,h.watch=!1,h.verbose=null,process.env.NO_WATCHMAN&&(h.watchman=!1),delete h.findRelatedTests,delete h.listTests,delete h.forceExit,delete h.onlyChanged,delete h.onlyFailures,delete h.outputFile,delete h.passWithNoTests,delete h.watchAll,delete h.watchPlugins,delete h.testResultsProcessor,delete h.reporters,[2]}})})},testRunner,testFiles,testContexts,testFilesByPath,noopTestWatcher={setState:function(){},isInterrupted:function(){return!1},isWatchMode:function(){return!1}},configure=function(e){return __awaiter(void 0,void 0,void 0,function(){var t;return __generator(this,function(i){switch(i.label){case 0:return t=global.$_$session,testRunner?[4,createTestScheduler(jestConfig.globalConfig,{changedFiles:[],sourcesRelatedToTestsInChangedFiles:[]})]:[3,2];case 1:return testRunner=i.sent(),[2,testRunner];case 2:return[4,initializeJest()];case 3:return i.sent(),e&&jestConfig.configs.forEach(function(t){Object.keys(e).forEach(function(i){"bail"!==i&&"notify"!==i&&"collectCoverage"!==i&&"errorOnDeprecated"!==i&&"testRunner"!==i&&"verbose"!==i&&"watchPlugins"!==i&&("setupFilesAfterEnv"===i||"transformIgnorePatterns"===i?t[i]=t[i].concat(e[i]):t[i]=e[i])})}),[4,Promise.all(jestConfig.configs.map(function(e){return jestRuntime.module.createContext(e,{maxWorkers:jestConfig.globalConfig.maxWorkers,watchman:jestConfig.globalConfig.watchman})}))];case 4:return testContexts=i.sent(),t!==global.$_$session?[2]:[4,createTestScheduler(jestConfig.globalConfig,{changedFiles:[],sourcesRelatedToTestsInChangedFiles:[]})];case 5:return testRunner=i.sent(),[2,testRunner]}})})},getTestData=function(e){return e.map(function(e){return{path:e,context:testContexts.length>1?testContexts.filter(function(t){return!(t.config.testMatch&&t.config.testMatch.length&&!t.config.testMatch.some(function(t){return utils.pathMatchesPattern(e,t,{micromatch:!0})}))}).reduce(function(t,i){e&&(e=e.normalize());var r=e.replace((i.config.rootDir||"").normalize(),"").length;return t?t.relativePathLength>r?{context:i,relativePathLength:r}:t:{context:i,relativePathLength:r}},void 0).context:testContexts[0]}})},globalSetupTeardown=function(e,t){return __awaiter(void 0,void 0,void 0,function(){var i,r,n,s,o,a;return __generator(this,function(l){switch(l.label){case 0:i={},l.label=1;case 1:l.trys.push([1,3,,4]);try{global.wallaby.processEnv||(global.wallaby.processEnv=JSON.parse(JSON.stringify(process.env))),i=global.wallaby.processEnv}catch(c){return tracer.reportGlobalError("Failed to serialize existing process.env: "+(c&&c.message||"")),e.completeRun(),[2]}return[4,jestRunGlobalHook.module({allTests:t,globalConfig:jestConfig.globalConfig,moduleName:"globalSetup"})];case 2:return l.sent(),[3,4];case 3:return r=l.sent(),tracer.reportGlobalError("Failed to run jest globalSetup: "+(r&&r.message||"")),e.completeRun(),[2];case 4:n={};try{s=JSON.parse(JSON.stringify(process.env)),o=Object.keys(s).filter(function(e){return void 0===i[e]||i[e]!==s[e]}).map(function(e){return{variable:e,value:s[e]}}),a=Object.keys(i).filter(function(e){return void 0===s[e]}),n={updates:o,deletions:a}}catch(c){return tracer.reportGlobalError("Failed to serialize process.env: "+(c&&c.message||"")),e.completeRun(),[2]}return tracer.globalSetupComplete(n),global.wallaby.teardown=function(){return __awaiter(void 0,void 0,void 0,function(){var i;return __generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,jestRunGlobalHook.module({allTests:t,globalConfig:jestConfig.globalConfig,moduleName:"globalTeardown"})];case 1:return r.sent(),e.completeRun(),[3,3];case 2:return i=r.sent(),tracer.reportGlobalError("Failed to run jest globalTeardown: "+(i&&i.message||"")),e.completeRun(),[2];case 3:return[2]}})})},[2]}})})};tracer.start(function(){return __awaiter(void 0,void 0,void 0,function(){var e,t,i,r,n,s;return __generator(this,function(o){switch(o.label){case 0:return o.trys.push([0,8,,9]),testFilesByPath=void 0,e=global.$_$session,t=new WallabyRunner(e),[4,configure()];case 1:if(i=o.sent(),!i||!t.isActive())return[2];if(clearDefaultResolverCache)try{clearDefaultResolverCache()}catch(a){}return i.removeReporter(WallabyRunner),i.addReporter(t),r=getTestData(testFiles),global.wallaby.runGlobals?[4,globalSetupTeardown(t,r)]:[3,3];case 2:return o.sent(),[3,7];case 3:return o.trys.push([3,5,6,7]),jestConfig.globalConfig.updateSnapshot=tracer.canUpdateSnapshots()?"all":process.env.CI?"none":"new",t.isActive()?(tracer.debugLog("Scheduling Jest Test Run ("+e+"): "+(new Date).toISOString()),[4,i.scheduleTests(r,noopTestWatcher)]):[2];case 4:return o.sent(),[3,7];case 5:return n=o.sent(),tracer.debugLog("Jest Test Error: "+(new Date).toISOString()),n&&console.error(n.stack),[3,7];case 6:return handleUncaughtException(),tracer.debugLog("Jest Test Run Complete ("+e+"): "+(new Date).toISOString()),t.completeRun(),[7];case 7:return[3,9];case 8:return s=o.sent(),tracer.reportGlobalError("Failed to initialize wallaby jest.\n"+(s&&s.message||"")+"\n"+(s&&s.stack||"")),[3,9];case 9:return[2]}})})});var getFileData=function(e){var t=global.wallaby.localProjectDir,i=global.wallaby.projectCacheDir,r=utils.normalizePath(e.replace(t,"").replace(i,""));return"/"===r[0]&&(r=r.substr(1)),tracer._filePathToFileData[r]},initializeTestsByFilePath=function(){testFilesByPath||(testFilesByPath={},global.$_$testFiles.forEach(function(e){testFilesByPath[e.path]=e}))};tracer._fileCacheKey=function(e){var t=getFileData(e);if(t){var i=t.path+"_"+workerId+"_"+t.id+"_"+t.ts;if(t.childFilePath){var r=getFileData(t.childFilePath);r&&(i+="_"+r.id+"_"+r.ts)}return i}},tracer._fileId=function(e){var t=getFileData(e);if(t)return t.id},tracer._readFileSync=function(e){return fs.readFileSync(e)},tracer._remapInlineSnapshots=function(e){initializeTestsByFilePath(),e.forEach(function(e){if(e.frame){var t=testFilesByPath[path.normalize(e.frame.file)];t&&t.lineMap&&(e.frame.line=utils.getOriginalLineByGeneratedLine(t.lineMap,e.frame.line,e.frame.column)||e.frame.line,e.frame.column=1)}})},tracer._matchSnapshot=function(e){var t=e.key,i=e.snapshotPath;if(tracer._expectedMatchSnapshotCall){var r=__read(tracer._expectedMatchSnapshotCall,2),n=r[0],s=r[1];delete tracer._expectedMatchSnapshotCall,tracer._matchSnapshotCalls||(tracer._matchSnapshotCalls=[]),tracer._matchSnapshotCalls.push({fileId:n,snapshotCallRangeId:s,snapshotKey:t,snapshotPath:utils.normalizePath(path.relative(localProjectRoot,i))})}},tracer._beforeMatchSnapshot=function(e,t){tracer._expectedMatchSnapshotCall=[e,t]},tracer._readCodeCacheFile=function(e,t,i,r){var n=getFileData(e);if(n){if(n.runnerExistingCachePath=t+".wallaby",n.useRunnerCache)return i(t);var s=r(n.runnerExistingCachePath);if(s)try{n.runnerExistingCache=JSON.parse(s)}catch(o){return null}return null}return i(t)};var readFileSync=fs.readFileSync;fs.readFileSync=function(e){var t=getFileData(e);return t&&t.inOriginalFilesCache&&(arguments[0]=path.join(originalCacheRoot,t.path)),readFileSync.apply(this,arguments)};var writeFileSync=fs.writeFileSync;fs.writeFileSync=function(e,t){
if(e.endsWith(".snap"))return writeFileSync.apply(this,arguments);var i=getFileData(e);if(!i)return writeFileSync.apply(this,arguments);var r=(new Error).stack.toLowerCase();if(r.indexOf("jest-snapshot")===-1||r.indexOf("inline")===-1)return writeFileSync.apply(this,arguments);var n=i.inOriginalFilesCache?path.join(originalCacheRoot,i.path):e,s=readFileSync(n).toString(),o=t.toString();tracer.sendFileChange({id:i.id,oldContent:s,newContent:o})},tracer._extendJestTransformer=function(e,t){var i=getFileData(e);if(!i||!i.instrument)return t;var r=function(e,t,i){return!!e.test||!(i.coveragePathIgnorePatterns||[]).some(function(e){return utils.pathMatchesPattern(t,e,{absolute:!0})})&&(".node"!==path.extname(t)&&".json"!==path.extname(t)&&!i.collectCoverageFrom.some(function(t){return"!"===t[0]&&!utils.pathMatchesPattern(e.path,t,{micromatch:!0})})&&i.collectCoverageFrom.some(function(t){return"!"!==t[0]&&utils.pathMatchesPattern(e.path,t,{micromatch:!0})}))},n=function(e){e.transformer&&(e.getCacheKey=e.transformer.getCacheKey,e.process=e.transformer.process,e.getCacheKeyAsync=e.transformer.getCacheKeyAsync,e.processAsync=e.transformer.processAsync),e.getCacheKey||e.getCacheKeyAsync||(e.getCacheKey=function(e,t,i,r){return"string"!=typeof i&&(r=i,i=r.configString),crypto.createHash("md5").update(e).update(i).update(r&&r.instrument?"instrument":"").update(t).digest("hex")});var t=function(e,t,i,r,n){var s=getFileData(t);if(s)if(n+="W"+s.id,s.childFilePath)try{var o=getFileData(s.childFilePath);if(o){var a=fs.readFileSync(s.childFilePath);n+=crypto.createHash("md5").update(a).digest("hex")+o.id,s.useRunnerCache=o.runnerCacheKey===n,o.runnerCacheKey=n}else n="",s.useRunnerCache=!1}catch(l){n="",s.useRunnerCache=!1}else s.useRunnerCache=s.runnerCacheKey===n,s.runnerCacheKey=n;return n};if(e.getCacheKey&&!e.getCacheKey._wallabyExtended){var i=e.getCacheKey;e.getCacheKey=function(r,n,s,o){var a=i.call(e,r,n,s,o);return t(r,n,s,o,a)},e.getCacheKey._wallabyExtended=!0}if(e.getCacheKeyAsync&&!e.getCacheKeyAsync._wallabyExtended){var n=e.getCacheKeyAsync;e.getCacheKeyAsync=function(i,r,s,o){return __awaiter(this,void 0,void 0,function(){var a;return __generator(this,function(l){switch(l.label){case 0:return[4,n.call(e,i,r,s,o)];case 1:return a=l.sent(),[2,t(i,r,s,o,a)]}})})},e.getCacheKeyAsync._wallabyExtended=!0}var s=function(e,t,i,n,s){i=i.config||i,s.runnerExistingCache&&(s.code=s.runnerExistingCache.code,s.map=s.runnerExistingCache.map);var o=!0;s&&null===s.code&&(s.code=e,o=!1);var a;s&&s.scriptSrc&&(a=getFileData(t),a&&(t=path.join(t,"..",s.scriptSrc)),delete s.scriptSrc);var l=getFileData(t);if(l&&!global.wallaby.runGlobals&&r(l,t,i)){var c=l.id;if("string"==typeof s?s={code:s,map:utils.getSourceMapFromCode(s)}:o&&"string"==typeof s.code&&!s.map&&(s.map=utils.getSourceMapFromCode(s.code)),"string"==typeof s.map&&(s.map=JSON.parse(s.map)),s.map&&s.map.constructor&&"SourceMapGenerator"===s.map.constructor.name&&(s.map=JSON.parse(s.map.toString())),!s.runnerExistingCache){var u=void 0;try{u=!!(i&&i.transform&&i.transform.find(function(e){return e[1]&&"string"==typeof e[1]&&e[1].includes("ts-jest")}))}catch(h){u=!1}a&&a.runnerExistingCachePath&&!l.runnerExistingCachePath&&(l.runnerExistingCachePath=a.runnerExistingCachePath),u&&l.runnerExistingCachePath&&writeFileAtomic(l.runnerExistingCachePath,JSON.stringify({code:s.code,map:s.map}))}var d=s.code,p=_.extend({},global.$_$tracer._hints);l.test&&(p.allowIgnoringCoverageInTests||(p=_.omit(p,"ignoreCoverage","ignoreCoverageForFile"))),p=_.omit(p,"testFileSelection");var f;s.map&&(l.changeStart||l.logMarkers&&l.logMarkers.length||l.extractedComments&&!l.extractedComments.isCoverageIgnored||l.test)&&(f=new utils.SourceMapConsumer(s.map));var g=utils.mapTextPosition(l.changeStart&&l.changePosition,f),v=l.logMarkers||[],m=void 0;try{m=utils.instrument(d,{file:c,test:l.test,fileName:path.basename(l.path),testFileChangeStart:g,hints:p,recordValues:global.$_$tracer._autoConsoleLog,recordMatchSnapshotRanges:!0,preserveComments:global.$_$tracer._preserveComments,logMarkers:v.map(function(e){return{originalRange:e.range,range:utils.mapOriginalRangeToTransformed(f,e.range),changeId:e.id,traceId:e.traceId,expanded:e.expanded,"new":e["new"],exp:e.exp,action:e.action}}),extractedComments:utils.remapComments(l.extractedComments,d,f)})}catch(h){throw utils.formatInstrumentationError(h,d,l.path)}if(m.liveCommentLines&&s.map?(f||(f=new utils.SourceMapConsumer(s.map)),m.liveCommentLines=_.chain(m.liveCommentLines).map(function(e,t){return{line:parseInt(t,10),column:e+1}}).map(function(e){var t=e.line,i=e.column;return utils.mapTransformedRangeToOriginal(f,[t,i,t,i])}).filter(function(e){return e&&e.length}).map(function(e){return e[0]}).value()):m.liveCommentLines&&(m.liveCommentLines=Object.keys(m.liveCommentLines).map(function(e){return parseInt(e,10)}).filter(function(e){return e}).map(function(e){return e})),tracer.sendTransformedFile({id:c,parentFilePath:a&&a.path,transformed:_.omit(s,"code"),instrumented:_.omit(m,"code","map"),lineMap:utils.updateFileMap({},s.map?[s.map,m.map]:[m.map]),ts:l.ts,originalTs:l.originalTs,runnerCacheKey:l.runnerCacheKey,matchSnapshotRanges:m.matchSnapshotRanges&&m.matchSnapshotRanges.length&&f?m.matchSnapshotRanges.map(function(e){return utils.mapTransformedRangeToOriginal(f,e)}):void 0,transformedTime:(new Date).toISOString(),runnerCacheHit:!!s.runnerExistingCache}),m.numberOfFunctions!==l.numberOfFunctions&&delete m.testName,l.test&&(!global.$_$traceContext||!global.$_$traceContext.test))if(m.testName&&l.allowedToRunSingleTestOnly){"*"===global.$_$tests&&(global.$_$tests={});var y=global.$_$tests[":?"]=global.$_$tests[":?"]||{};y[":"+m.testName]="*"}else global.$_$tests&&global.$_$tests[":?"]&&(global.$_$tests="*");var b=utils.docBlockComment(s.code).replace(/\r?\n|\r/g," ");b&&(m.code=b+m.code),s.code=m.code,delete s.map;for(var k=global.$_$coverage[c]=[],T=0;T<m.ranges.length;T++)k[T]={};s.wallaby=!0}return s};if(e.process&&!e.process._wallabyExtended){var o=e.process;e.process=function(t,i,r,n){var a,l,c=getFileData(i);return c&&c.runnerExistingCache?(a={runnerExistingCache:c.runnerExistingCache},delete c.runnerExistingCache):(a=o.call(e,t,i,r,n),l=a.wallaby),delete a.wallaby,l?a:s(t,i,r,n,a)},e.process._wallabyExtended=!0}if(e.processAsync&&!e.processAsync._wallabyExtended){var a=e.processAsync;e.processAsync=function(t,i,r,n){return __awaiter(this,void 0,void 0,function(){var o,l,c;return __generator(this,function(u){switch(u.label){case 0:return o=getFileData(i),o&&o.runnerExistingCache?(l={runnerExistingCache:o.runnerExistingCache},delete o.runnerExistingCache,[3,3]):[3,1];case 1:return[4,a.call(e,t,i,r,n)];case 2:l=u.sent(),c=l.wallaby,u.label=3;case 3:return delete l.wallaby,[2,c?l:s(t,i,r,n,l)]}})})},e.processAsync._wallabyExtended=!0}return e._wallabyExtended=!0,e.transformer=e.transformer||{},e.transformer.getCacheKey=e.getCacheKey,e.transformer.process=e.process,e.transformer.getCacheKeyAsync=e.getCacheKeyAsync,e.transformer.processAsync=e.processAsync,e};return t?t&&!t._wallabyExtended?n(t):t:n({getCacheKey:function(e,t,i,r){return"string"!=typeof i&&(r=i,i=r.configString),crypto.createHash("md5").update(e).update(i).update(r&&r.instrument?"instrument":"").update(t).digest("hex")},process:function(e,t,i,r){return{code:null,map:null}}})},module.exports={init:function(e){return testFiles=e,{configure:function(e){testRunner||configure(e)["catch"](function(e){return console.error("Error while trying to configure jest: "+(e&&e.message||""))})}}}};